/*! Swipeshow (c) 2013 Rico Sta. Cruz, MIT license. */// Opinionated, touch-enabled simple slideshow using Cycler.js.
//
//     <div class="slideshow">
//       <ul class="slides">
//         <li class="slide"> ... </il>
//         <li class="slide"> ... </li>
//         <li class="slide"> ... </li>
//       </ul>
//     
//       <!-- optional controls: -->
//       <button class="next"></button>
//       <button class="previous"></button>
//     </div>
//
// To use:
//
//     $(".slideshow").swipeshow();
//
// Options (all of these are optional):
//
//     $(".slideshow").swipeshow({
//       autostart: true,
//       interval: 3000,     /* Time between movement (ms) */
//       initial: 0,         /* First slide's index */
//       speed: 700,         /* Animation speed (ms) */
//       friction: 0.3,      /* What happens when you swipe out of bounds? */
//       mouse: true,        /* enable mouse dragging controls? */
//
//       onactivate: function(){},
//       onpause: function(){},
//
//       $next:     $("button.next"),
//       $previous: $("button.previous"),
//
//       // Not implemented yet:
//       $pegs:     $("ul.pegs")
//     });
//
//     $(".slideshow").swipeshow().next();
//     $(".slideshow").swipeshow().previous();
//     $(".slideshow").swipeshow().goTo(2);
//
//     $(".slideshow").swipeshow().pause();
//     $(".slideshow").swipeshow().start();
//
// Assumptions it makes:
//
//  - Markup is like above (`.slideshow > .slides > .slide`).
//  - Buttons (optional), by default, will be found in `.slideshow > .next` (and `.previous`)
//  - If there are images inside the slides, it will wait to load them before
//    starting the slideshow.
(function(a){function d(a,d,e){a.data("swipeshow:left",d),b?e===0?a.css({transform:"translate3d("+d+"px,0,0)",transition:"none"}):a.css({transform:"translate3d("+d+"px,0,0)",transition:"all "+e+"ms ease"}):e===0?a.css({left:d}):a.animate({left:d},e),a.addClass("gliding"),typeof c=="undefined"&&clearTimeout(c),c=setTimeout(function(){a.removeClass("gliding"),c=undefined},e)}function e(a){var c=null;if(b){var d=a.css("transform"),e=d.replace(/ /g,"").match(/matrix\((?:[\-\.\d+]+,){4}([\-\.\d+]+)/);if(e[1])return+e[1]}return a.data("swipeshow:left")||0}function f(c,f,h,i){var j=!1,k,l,m,n,o=c.width(),p=h.list.length,q=i.friction;f.find("img").on("mousedown",function(a){a.preventDefault()}),f.on("touchstart.swipeshow"+(i.mouse?" mousedown.swipeshow":""),function(c){c.type==="mousedown"&&c.preventDefault();if(h.disabled)return;if(f.is(":animated"))return;if(a(c.target).is("button, a, [data-unswipeable]"))return;f.addClass("grabbed"),a("html").addClass("swipeshow-grabbed"),j=!0,k={x:g(c)},l={x:e(f),started:h.isStarted()},m=0,n=null,b&&f.css({transform:f.css("transform"),transition:"none"}),l.started&&h.pause()}),a(document).on("touchmove.swipeshow"+(i.mouse?" mousemove.swipeshow":""),function(a){if(h.disabled)return;if(f.is(":animated"))return;if(!j)return;var b=g(a);if(isNaN(b))return;m=b-k.x;var c=l.x+m,e=-1*o*(p-1);Math.abs(m)>2&&a.preventDefault(),c>0&&(c*=q),c<e&&(c=e+(c-e)*q),n=+(new Date),d(f,c,0)}),a(document).on("touchend.swipeshow"+(i.mouse?" mouseup.swipeshow":""),function(b){if(h.disabled)return;if(f.is(":animated"))return;if(!j)return;var c=e(f);f.removeClass("grabbed"),a("html").removeClass("swipeshow-grabbed");var d=-1*Math.round(c/o);if(n&&h.current===d){var g=+(new Date)-n;if(Math.abs(m)>10&&g<20){var i=m<0?-1:1;d-=i}}d<0&&(d=0),d>h.list.length-1&&(d=h.list.length-1),h.goTo(d),b.preventDefault(),l.started&&h.start(),j=!1})}function g(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0])return a.originalEvent.touches[0].clientX;if(a.clientX)return a.clientX}a.swipeshow={},a.swipeshow.version="0.9.0";var b=!!a("<div>").css({transition:"all"}).css("transition");a.fn.swipeshow=function(b){return a(this).data("swipeshow")?a(this).data("swipeshow"):(b||(b={}),b=a.extend({},{speed:600,friction:.3,mouse:!0},b),a(this).each(function(){var c=a(this),e=c.find("> .slides"),g=e.find("> .slide"),h=c.width(),i=new Cycler(g,a.extend({},b,{onactivate:function(c,f,g,i){b.onactivate&&b.onactivate(c,f,g,i),g&&a(g).removeClass("active"),c&&a(c).addClass("active"),d(e,-1*h*f,b.speed)}}));e.css({width:h*g.length}),c.addClass("ontouchstart"in document.documentElement?"touch":"no-touch");if(b.autostart!==!1){var j=c.find("img");j.length>0?(i.disabled=!0,c.addClass("disabled"),j.onloadall(function(){i.disabled=!1,c.removeClass("disabled"),i.start()})):i.start()}f(c,e,i,b);var k=b.$next||c.find(".next");k.on("click",function(a){a.preventDefault(),i.disabled||i.next()});var l=b.$previous||c.find(".previous");l.on("click",function(a){a.preventDefault(),i.disabled||i.previous()}),c.data("swipeshow",i)}),a(this).data("swipeshow"))};var c})(jQuery),function(a){a.fn.onloadall=function(b){var c=this,d={loaded:0,total:c.length};return c.on("load.onloadall",function(){++d.loaded>=d.total&&b.apply(c)}),a(function(){c.each(function(){this.complete&&a(this).trigger("load.onloadall")})}),this}}(jQuery),function(){function a(a,b){return this.interval=b.interval||3e3,this.onactivate=b.onactivate||function(){},this.onpause=b.onpause||function(){},this.onstart=b.onstart||function(){},this.initial=typeof b.initial=="undefined"?0:b.initial,this.autostart=typeof b.initial=="undefined"?!0:b.autostart,this.list=a,this.current=null,this.goTo(this.initial),this.autostart&&typeof b.interval=="number"&&this.start(),this}a.prototype={start:function(a){var b=this;return!b.isStarted()&&!a&&b.onstart.apply(b),b.pause(!0),b._timer=setTimeout(function(){b.next()},b.interval),b},pause:function(a){return this.isStarted()&&(a||this.onpause.apply(this),clearTimeout(this._timer),this._timer=null),this},restart:function(a){return this._timer&&this.pause(!0).start(a),this},previous:function(){return this.next(-1)},isStarted:function(){return!!this._timer},isPaused:function(){return!this.isStarted()},next:function(a){typeof a=="undefined"&&(a=1);var b=this.list.length;if(b===0)return this;var c=(this.current+a+b*2)%b;return this.goTo(c)},goTo:function(a){if(typeof a!="number")return this;var b=this.current;return this.current=a,this.onactivate.call(this,this.list[a],a,this.list[b],b),this.restart(!0),this}},window.Cycler=a}()