/*! Swipeshow (c) 2013 Rico Sta. Cruz, MIT license. */// Opinionated, touch-enabled simple slideshow using Cycler.js.
//
//     <div class="slideshow">
//       <ul class="slides">
//         <li class="slide"> ... </il>
//         <li class="slide"> ... </li>
//         <li class="slide"> ... </li>
//       </ul>
//     
//       <!-- optional controls: -->
//       <button class="next"></button>
//       <button class="previous"></button>
//     </div>
//
// To use:
//
//     $(".slideshow").swipeshow();
//
// Options (all of these are optional):
//
//     $(".slideshow").swipeshow({
//       autostart: true,
//       interval: 3000,     /* Time between movement (ms) */
//       initial: 0,         /* First slide's index */
//       speed: 700,         /* Animation speed (ms) */
//       friction: 0.3,      /* What happens when you swipe out of bounds? */
//       mouse: true,        /* enable mouse dragging controls? */
//
//       onactivate: function(){},
//       onpause: function(){},
//
//       $next:     $("button.next"),
//       $previous: $("button.previous"),
//
//       // Not implemented yet:
//       $pegs:     $("ul.pegs")
//     });
//
//     $(".slideshow").swipeshow().next();
//     $(".slideshow").swipeshow().previous();
//     $(".slideshow").swipeshow().goTo(2);
//
//     $(".slideshow").swipeshow().pause();
//     $(".slideshow").swipeshow().start();
//
// Assumptions it makes:
//
//  - Markup is like above (`.slideshow > .slides > .slide`).
//  - Buttons (optional), by default, will be found in `.slideshow > .next` (and `.previous`)
//  - If there are images inside the slides, it will wait to load them before
//    starting the slideshow.
(function(a){function d(a,d,e){a.data("swipeshow:left",d),b?e===0?a.css({transform:"translate3d("+d+"px,0,0)",transition:"none"}):a.css({transform:"translate3d("+d+"px,0,0)",transition:"all "+e+"ms ease"}):e===0?a.css({left:d}):a.animate({left:d},e),a.addClass("gliding"),typeof c=="undefined"&&clearTimeout(c),c=setTimeout(function(){a.removeClass("gliding"),c=undefined},e)}function e(a){return a.data("swipeshow:left")||0}function f(b,c,f,h){var i=!1,j,k,l,m,n=b.width(),o=f.list.length,p=h.friction;c.find("img").on("mousedown",function(a){a.preventDefault()}),c.on("touchstart.swipeshow"+(h.mouse?" mousedown.swipeshow":""),function(b){b.type==="mousedown"&&b.preventDefault();if(f.disabled)return;if(c.is(":animated"))return;c.addClass("grabbed"),a("html").addClass("swipeshow-grabbed"),i=!0,j={x:g(b)},k={x:e(c),started:f.isStarted()},l=0,f.pause(),m=+(new Date)}),a(document).on("touchmove.swipeshow"+(h.mouse?" mousemove.swipeshow":""),function(a){if(f.disabled)return;if(c.is(":animated"))return;if(!i)return;var b=g(a);isNaN(b)||(l=b-j.x);var e=k.x+l,h=-1*n*(o-1);Math.abs(l)>5&&a.preventDefault(),e>0&&(e*=p),e<h&&(e=h+(e-h)*p),d(c,e,0)}),a(document).on("touchend.swipeshow"+(h.mouse?" mouseup.swipeshow":""),function(b){if(f.disabled)return;if(c.is(":animated"))return;if(!i)return;var d=e(c);c.removeClass("grabbed"),a("html").removeClass("swipeshow-grabbed");var g=-1*Math.round(d/n);g<0&&(g=0),g>f.list.length-1&&(g=f.list.length-1),f.goTo(g),b.preventDefault(),k.started&&f.start(),i=!1})}function g(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0])return a.originalEvent.touches[0].clientX;if(a.clientX)return a.clientX}a.swipeshow={},a.swipeshow.version="0.9.0",a.fn.swipeshow=function(b){return a(this).data("swipeshow")?a(this).data("swipeshow"):(b||(b={}),b=a.extend({},{speed:700,friction:.3,mouse:!0},b),a(this).each(function(){var c=a(this),e=c.find("> .slides"),g=e.find("> .slide"),h=c.width(),i=new Cycler(g,a.extend({},b,{onactivate:function(c,f,g,i){b.onactivate&&b.onactivate(c,f,g,i),g&&a(g).removeClass("active"),c&&a(c).addClass("active"),d(e,-1*h*f,b.speed)}}));e.css({width:h*g.length}),c.addClass("ontouchstart"in document.documentElement?"touch":"no-touch");if(b.autostart!==!1){var j=c.find("img");j.length>0?(i.disabled=!0,c.addClass("disabled"),j.onloadall(function(){i.disabled=!1,c.removeClass("disabled"),i.start()})):i.start()}f(c,e,i,b);var k=b.$next||c.find(".next");k.on("click",function(a){a.preventDefault(),i.disabled||i.next()});var l=b.$previous||c.find(".previous");l.on("click",function(a){a.preventDefault(),i.disabled||i.previous()}),c.data("swipeshow",i)}),a(this).data("swipeshow"))};var b=!0,c})(jQuery),function(a){a.fn.onloadall=function(b){var c=this,d={loaded:0,total:c.length};return c.on("load.onloadall",function(){++d.loaded>=d.total&&b.apply(c)}),a(function(){c.each(function(){this.complete&&a(this).trigger("load.onloadall")})}),this}}(jQuery),function(){function a(a,b){return this.interval=b.interval||3e3,this.onactivate=b.onactivate||function(){},this.onpause=b.onpause||function(){},this.onstart=b.onstart||function(){},this.initial=typeof b.initial=="undefined"?0:b.initial,this.autostart=typeof b.initial=="undefined"?!0:b.autostart,this.list=a,this.current=null,this.goTo(this.initial),this.autostart&&typeof b.interval=="number"&&this.start(),this}a.prototype={start:function(a){var b=this;return!b.isStarted()&&!a&&b.onstart.apply(b),b.pause(!0),b._timer=setTimeout(function(){b.next()},b.interval),b},pause:function(a){return this.isStarted()&&(a||this.onpause.apply(this),clearTimeout(this._timer),this._timer=null),this},restart:function(a){return this._timer&&this.pause(!0).start(a),this},previous:function(){return this.next(-1)},isStarted:function(){return!!this._timer},isPaused:function(){return!this.isStarted()},next:function(a){typeof a=="undefined"&&(a=1);var b=this.list.length;if(b===0)return this;var c=(this.current+a+b*2)%b;return this.goTo(c)},goTo:function(a){if(typeof a!="number")return this;var b=this.current;return this.current=a,this.onactivate.call(this,this.list[a],a,this.list[b],b),this.restart(!0),this}},window.Cycler=a}()