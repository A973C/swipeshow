/*! Swipeshow (c) 2013 Rico Sta. Cruz, MIT license. */// Opinionated, touch-enabled simple slideshow using Cycler.js.
//
//     <div class="slideshow">
//       <ul class="slides">
//         <li class="slide"> ... </il>
//         <li class="slide"> ... </li>
//         <li class="slide"> ... </li>
//       </ul>
//     
//       <!-- optional controls: -->
//       <button class="next"></button>
//       <button class="previous"></button>
//     </div>
//
// To use:
//
//     $(".slideshow").swipeshow();
//
// Options (all of these are optional):
//
//     $(".slideshow").swipeshow({
//       autostart: true,
//       interval: 3000,     /* Time between movement (ms) */
//       initial: 0,         /* First slide's index */
//       speed: 700,         /* Animation speed (ms) */
//       friction: 0.3,      /* What happens when you swipe out of bounds? */
//       mouse: true,        /* enable mouse dragging controls? */
//
//       onactivate: function(){},
//       onpause: function(){},
//
//       $next:     $("button.next"),
//       $previous: $("button.previous"),
//
//       // Not implemented yet:
//       $pegs:     $("ul.pegs")
//     });
//
//     $(".slideshow").swipeshow().next();
//     $(".slideshow").swipeshow().previous();
//     $(".slideshow").swipeshow().goTo(2);
//
//     $(".slideshow").swipeshow().pause();
//     $(".slideshow").swipeshow().start();
//
// Assumptions it makes:
//
//  - Markup is like above (`.slideshow > .slides > .slide`).
//  - Buttons (optional), by default, will be found in `.slideshow > .next` (and `.previous`)
//  - If there are images inside the slides, it will wait to load them before
//    starting the slideshow.
(function(a){function f(a,c,d){a.data("swipeshow:left",c),b?d===0?a.css({transform:"translate3d("+c+"px,0,0)",transition:"none"}):a.css({transform:"translate3d("+c+"px,0,0)",transition:"all "+d+"ms ease"}):d===0?a.css({left:c}):a.animate({left:c},d),a.addClass("gliding"),typeof e=="undefined"&&clearTimeout(e),e=setTimeout(function(){a.removeClass("gliding"),e=undefined},d)}function g(a){return a.data("swipeshow:left")||0}function h(b,c,e,h){var i=!1,k,l,m,n,o,p=b.width(),q=e.list.length,r=h.friction,s=".swipeshow.swipeshow-"+ ++d;b.data("swipeshow:tag",s),c.find("img").on("mousedown"+s,function(a){a.preventDefault()}),c.on("touchstart"+s+(h.mouse?" mousedown"+s:""),function(b){b.type==="mousedown"&&b.preventDefault();if(e.disabled)return;c.is(":animated")&&c.stop(),a(b.target).is("button, a, [data-tappable]")?o=100:o=0,c.addClass("grabbed"),a("html").addClass("swipeshow-grabbed"),i=!0,k={x:j(b)},l={x:g(c),started:e.isStarted()},m=0,n=null,l.started&&e.pause()}),a(document).on("touchmove"+s+(h.mouse?" mousemove"+s:""),function(a){if(e.disabled)return;if(c.is(":animated"))return;if(!i)return;var b=j(a);if(isNaN(b))return;m=b-k.x,Math.abs(m)<=o&&(m=0);var d=l.x+m,g=-1*p*(q-1);Math.abs(m)>3&&a.preventDefault(),d>0&&(d*=r),d<g&&(d=g+(d-g)*r),n=+(new Date),f(c,d,0)}),a(document).on("touchend"+s+(h.mouse?" mouseup"+s:""),function(b){if(e.disabled)return;if(c.is(":animated"))return;if(!i)return;var d=g(c);c.removeClass("grabbed"),a("html").removeClass("swipeshow-grabbed");var f=-1*Math.round(d/p);if(n&&e.current===f){var h=+(new Date)-n;if(Math.abs(m)>10&&h<20){var j=m<0?-1:1;f-=j}}f<0&&(f=0),f>e.list.length-1&&(f=e.list.length-1),e.goTo(f),b.preventDefault(),l.started&&e.start(),i=!1})}function i(a,b,d){if(c)return;var e=a.data("swipeshow:tag"),f=!1;a.on("mouseenter"+e,function(){b.isStarted()&&(f=!0,b.pause())}),a.on("mouseleave"+e,function(){f&&(f=!1,b.start())})}function j(a){if(a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0])return a.originalEvent.touches[0].clientX;if(a.clientX)return a.clientX}a.swipeshow={},a.swipeshow.version="0.9.2";var b=typeof a("<div>").css({transition:"all"}).css("transition")=="string",c="ontouchstart"in document.documentElement,d=0;a.fn.swipeshow=function(b){return b||(b={}),b=a.extend({},{speed:400,friction:.3,mouse:!0},b),a(this).each(function(){var d=a(this),e=d.find("> .slides"),g=e.find("> .slide");if(d.data("swipeshow"))return;var j=d.width();d.addClass("paused swipeshow-active");var k=new Cycler(g,a.extend({},b,{autostart:!1,onactivate:function(c,d,g,h){b.onactivate&&b.onactivate(c,d,g,h),g&&a(g).removeClass("active"),c&&a(c).addClass("active"),f(e,-1*j*d,b.speed)},onpause:function(){b.onpause&&b.onpause(),d.addClass("paused").removeClass("running")},onstart:function(){b.onstart&&b.onstart(),d.removeClass("paused").addClass("running")}}));e.css({width:j*g.length}),d.addClass(c?"touch":"no-touch");if(b.autostart!==!1){var l=d.find("img");l.length>0?(k.disabled=!0,d.addClass("disabled"),l.onloadall(function(){k.disabled=!1,d.removeClass("disabled"),k.start()})):k.start()}h(d,e,k,b),i(d,k,b);var m=b.$next||d.find(".next");m.on("click",function(a){a.preventDefault(),k.disabled||k.next()});var n=b.$previous||d.find(".previous");n.on("click",function(a){a.preventDefault(),k.disabled||k.previous()}),d.data("swipeshow",k)}),a(this).data("swipeshow")},a.fn.unswipeshow=function(){return this.each(function(){var b=a(this),c=b.find("> .slides"),d=c.find("> .slide"),e=b.data("swipeshow"),f=b.data("swipeshow:tag");e&&(e.pause(),c.find("img").off(f),c.off(f),a(document).off(f),b.data("swipeshow",null),b.removeClass("running paused swipeshow-active touch no-touch"),c.removeClass("gliding grabbed"),d.removeClass("active"),a("html").removeClass("swipeshow-grabbed"))}),this};var e})(jQuery),function(a){a.fn.onloadall=function(b){var c=this,d={loaded:0,total:c.length};return c.on("load.onloadall",function(){++d.loaded>=d.total&&b.apply(c)}),a(function(){c.each(function(){this.complete&&a(this).trigger("load.onloadall")})}),this}}(jQuery),function(){function a(a,b){return this.interval=b.interval||3e3,this.onactivate=b.onactivate||function(){},this.onpause=b.onpause||function(){},this.onstart=b.onstart||function(){},this.initial=typeof b.initial=="undefined"?0:b.initial,this.autostart=typeof b.autostart=="undefined"?!0:b.autostart,this.list=a,this.current=null,this.goTo(this.initial),this.autostart&&typeof b.interval=="number"&&this.start(),this}a.prototype={start:function(a){var b=this;return!b.isStarted()&&!a&&b.onstart.apply(b),b.pause(!0),b._timer=setTimeout(function(){b.next()},b.interval),b},pause:function(a){return this.isStarted()&&(a||this.onpause.apply(this),clearTimeout(this._timer),this._timer=null),this},restart:function(a){return this.isStarted()&&this.pause(!0).start(a),this},previous:function(){return this.next(-1)},isStarted:function(){return!!this._timer},isPaused:function(){return!this.isStarted()},next:function(a){typeof a=="undefined"&&(a=1);var b=this.list.length;if(b===0)return this;var c=(this.current+a+b*2)%b;return this.goTo(c)},goTo:function(a){if(typeof a!="number")return this;var b=this.current;return this.current=a,this.onactivate.call(this,this.list[a],a,this.list[b],b),this.restart(!0),this}},window.Cycler=a}()